{
  "configuration": {
    "model_name": "meta-llama/Meta-Llama-3.1-8B-Instruct",
    "data_path": "/checkpoint/amaia/scale/manufay/ppl_data/govreport.val.jsonl",
    "max_samples": 100,
    "max_length": 8192,
    "chunk_size": 128,
    "thresholds": {
      "kvzap": -5.5,
      "kvzap_no_sink": -5.5,
      "expected_attention": 0.3,
      "random": 0.8,
      "random_validation": 1.0,
      "observed_attention": 0.05,
      "h2o": 0.05
    },
    "sliding_window_size": 128,
    "kvzap_model_type": "mlp",
    "kvzap_scorer_model": "nvidia/KVzap-mlp-Llama-3.1-8B-Instruct",
    "num_texts": 100,
    "data_loader": "jsonl_text",
    "num_gpus": -1,
    "use_multigpu": true
  },
  "baseline": {
    "perplexity": 6.567224335041404,
    "avg_nll": 1.8820912675879646,
    "total_nll": 1425241.84375,
    "total_tokens": 757265,
    "num_samples": 100,
    "chunk_size": 128,
    "nll_per_sample": [
      1.8338420217311684,
      1.8702234159443292,
      1.7594457563550494,
      2.100598217555854,
      2.307898913441582,
      2.3039054316923537,
      2.052374557441094,
      1.9667928213893298,
      1.693993407398364,
      2.1001098766939323,
      1.562591441111924,
      1.987669393236479,
      1.6273404255319148,
      1.7793918001629108,
      2.0671735241502684,
      1.702176517571885,
      2.030948602124283,
      1.3080179282868525,
      1.9439442840156276,
      2.103284092296423,
      2.25601269686241,
      1.8689998394605876,
      1.5166285929737402,
      1.7260218631178708,
      1.9520205103162007,
      1.614149676474179,
      2.316811134171652,
      2.1435111707972165,
      1.8049383469661824,
      1.6515583692778628,
      0.879791844707606,
      2.0107434989622757,
      2.1091441826394823,
      1.805858203063319,
      2.037419118544744,
      2.024294957880601,
      2.1799733372833656,
      1.4737364180197778,
      2.2900596877869606,
      2.2131607862287876,
      1.7956293492858015,
      2.0492613844463436,
      1.914784519594677,
      2.06934440239287,
      1.5452936149432304,
      1.6494261223303792,
      2.3332926382615065,
      1.7281925283848125,
      1.845501159809547,
      1.156128576474744,
      1.9097790257599805,
      1.8480039067268954,
      1.588934181745874,
      1.7398617930532825,
      2.1522402637040656,
      1.7580271029178367,
      1.406055426687828,
      1.6350262483213283,
      2.1625289128758673,
      2.303992186546209,
      1.3975094616041996,
      2.1275790501770238,
      2.1715297277499697,
      1.9255280185569528,
      1.6566963740691003,
      1.5868941521181785,
      1.4968625498007968,
      2.3048467830545722,
      1.7679160053717495,
      1.8655841777560738,
      1.762361128067391,
      2.202295202051032,
      1.8426321572457576,
      1.937980710535954,
      2.2613636363636362,
      1.7532352582102309,
      1.678000244170431,
      1.7348309119765597,
      2.15053107068734,
      1.8242999096657633,
      1.9645952875106825,
      1.6112196313026492,
      2.069832743254792,
      1.8509339518984251,
      2.0405322915394946,
      1.878653221671509,
      1.5064722617354196,
      1.6123710026755,
      2.2748138200463925,
      2.3744353558784033,
      1.9945061653033818,
      1.6758332315956537,
      1.8203516054205835,
      2.0384954058192957,
      1.4618483701623732,
      1.9302893419606886,
      1.828592357465511,
      1.5622583762886597,
      1.9513774858602444,
      1.8560615309486022
    ],
    "method_name": "Baseline"
  },
  "methods": {
    "baseline": {
      "perplexity": 6.567224335041404,
      "avg_nll": 1.8820912675879646,
      "total_nll": 1425241.84375,
      "total_tokens": 757265,
      "num_samples": 100,
      "chunk_size": 128,
      "nll_per_sample": [
        1.8338420217311684,
        1.8702234159443292,
        1.7594457563550494,
        2.100598217555854,
        2.307898913441582,
        2.3039054316923537,
        2.052374557441094,
        1.9667928213893298,
        1.693993407398364,
        2.1001098766939323,
        1.562591441111924,
        1.987669393236479,
        1.6273404255319148,
        1.7793918001629108,
        2.0671735241502684,
        1.702176517571885,
        2.030948602124283,
        1.3080179282868525,
        1.9439442840156276,
        2.103284092296423,
        2.25601269686241,
        1.8689998394605876,
        1.5166285929737402,
        1.7260218631178708,
        1.9520205103162007,
        1.614149676474179,
        2.316811134171652,
        2.1435111707972165,
        1.8049383469661824,
        1.6515583692778628,
        0.879791844707606,
        2.0107434989622757,
        2.1091441826394823,
        1.805858203063319,
        2.037419118544744,
        2.024294957880601,
        2.1799733372833656,
        1.4737364180197778,
        2.2900596877869606,
        2.2131607862287876,
        1.7956293492858015,
        2.0492613844463436,
        1.914784519594677,
        2.06934440239287,
        1.5452936149432304,
        1.6494261223303792,
        2.3332926382615065,
        1.7281925283848125,
        1.845501159809547,
        1.156128576474744,
        1.9097790257599805,
        1.8480039067268954,
        1.588934181745874,
        1.7398617930532825,
        2.1522402637040656,
        1.7580271029178367,
        1.406055426687828,
        1.6350262483213283,
        2.1625289128758673,
        2.303992186546209,
        1.3975094616041996,
        2.1275790501770238,
        2.1715297277499697,
        1.9255280185569528,
        1.6566963740691003,
        1.5868941521181785,
        1.4968625498007968,
        2.3048467830545722,
        1.7679160053717495,
        1.8655841777560738,
        1.762361128067391,
        2.202295202051032,
        1.8426321572457576,
        1.937980710535954,
        2.2613636363636362,
        1.7532352582102309,
        1.678000244170431,
        1.7348309119765597,
        2.15053107068734,
        1.8242999096657633,
        1.9645952875106825,
        1.6112196313026492,
        2.069832743254792,
        1.8509339518984251,
        2.0405322915394946,
        1.878653221671509,
        1.5064722617354196,
        1.6123710026755,
        2.2748138200463925,
        2.3744353558784033,
        1.9945061653033818,
        1.6758332315956537,
        1.8203516054205835,
        2.0384954058192957,
        1.4618483701623732,
        1.9302893419606886,
        1.828592357465511,
        1.5622583762886597,
        1.9513774858602444,
        1.8560615309486022
      ],
      "method_name": "Baseline"
    },
    "kvzap(no_sink)": {
      "perplexity": 6.567224335041404,
      "avg_nll": 1.8820912675879646,
      "total_nll": 1425241.84375,
      "total_tokens": 757265,
      "num_samples": 100,
      "chunk_size": 128,
      "nll_per_sample": [
        1.8338420217311684,
        1.8702234159443292,
        1.7594457563550494,
        2.100598217555854,
        2.307898913441582,
        2.3039054316923537,
        2.052374557441094,
        1.9667928213893298,
        1.693993407398364,
        2.1001098766939323,
        1.562591441111924,
        1.987669393236479,
        1.6273404255319148,
        1.7793918001629108,
        2.0671735241502684,
        1.702176517571885,
        2.030948602124283,
        1.3080179282868525,
        1.9439442840156276,
        2.103284092296423,
        2.25601269686241,
        1.8689998394605876,
        1.5166285929737402,
        1.7260218631178708,
        1.9520205103162007,
        1.614149676474179,
        2.316811134171652,
        2.1435111707972165,
        1.8049383469661824,
        1.6515583692778628,
        0.879791844707606,
        2.0107434989622757,
        2.1091441826394823,
        1.805858203063319,
        2.037419118544744,
        2.024294957880601,
        2.1799733372833656,
        1.4737364180197778,
        2.2900596877869606,
        2.2131607862287876,
        1.7956293492858015,
        2.0492613844463436,
        1.914784519594677,
        2.06934440239287,
        1.5452936149432304,
        1.6494261223303792,
        2.3332926382615065,
        1.7281925283848125,
        1.845501159809547,
        1.156128576474744,
        1.9097790257599805,
        1.8480039067268954,
        1.588934181745874,
        1.7398617930532825,
        2.1522402637040656,
        1.7580271029178367,
        1.406055426687828,
        1.6350262483213283,
        2.1625289128758673,
        2.303992186546209,
        1.3975094616041996,
        2.1275790501770238,
        2.1715297277499697,
        1.9255280185569528,
        1.6566963740691003,
        1.5868941521181785,
        1.4968625498007968,
        2.3048467830545722,
        1.7679160053717495,
        1.8655841777560738,
        1.762361128067391,
        2.202295202051032,
        1.8426321572457576,
        1.937980710535954,
        2.2613636363636362,
        1.7532352582102309,
        1.678000244170431,
        1.7348309119765597,
        2.15053107068734,
        1.8242999096657633,
        1.9645952875106825,
        1.6112196313026492,
        2.069832743254792,
        1.8509339518984251,
        2.0405322915394946,
        1.878653221671509,
        1.5064722617354196,
        1.6123710026755,
        2.2748138200463925,
        2.3744353558784033,
        1.9945061653033818,
        1.6758332315956537,
        1.8203516054205835,
        2.0384954058192957,
        1.4618483701623732,
        1.9302893419606886,
        1.828592357465511,
        1.5622583762886597,
        1.9513774858602444,
        1.8560615309486022
      ],
      "compression_stats": {
        "avg_compression_ratio": 17.754961460925934,
        "sparsity_percentage": 1775.4961460925933,
        "total_keys_original": 193885440,
        "total_keys_kept": -846692215,
        "total_keys_discarded": 1040577655,
        "memory_reduction_percentage": -1675.4961460925933,
        "num_chunks_with_compression": 5834,
        "layer_compression_ratios": {
          "0": 22.19602543864723,
          "1": 21.98081908565028,
          "2": 19.76715268961288,
          "3": 22.187339164190348,
          "4": 19.797311392000598,
          "5": 18.846049634832383,
          "6": 20.438028570640608,
          "7": 18.377677077657932,
          "8": 15.298910798129464,
          "9": 14.950974399971269,
          "10": 13.252163868903352,
          "11": 17.066557448661865,
          "12": 21.6694404694613,
          "13": 10.060618892033716,
          "14": 12.732362194965626,
          "15": 14.511316339992387,
          "16": 13.657620197668475,
          "17": 17.56513125402747,
          "18": 19.770292914948985,
          "19": 17.277425453011737,
          "20": 14.119475100642092,
          "21": 18.79255488412076,
          "22": 17.79357210576946,
          "23": 19.691600555294865,
          "24": 17.6759530993718,
          "25": 19.542983988942055,
          "26": 18.195543109153,
          "27": 17.809665543442875,
          "28": 20.044371945178163,
          "29": 19.072214180245695,
          "30": 13.979604001380713,
          "31": 20.038010951080505
        },
        "sliding_window_size": 128,
        "total_keys_in_window": 3276800,
        "total_keys_outside_window": 190608640,
        "sparsity_with_window": 5.366971625099853,
        "sparsity_without_window": 5.459236554019797
      },
      "method_name": "KVzap(no_sink)"
    },
    "h2o": {
      "perplexity": 6.567224335041404,
      "avg_nll": 1.8820912675879646,
      "total_nll": 1425241.84375,
      "total_tokens": 757265,
      "num_samples": 100,
      "chunk_size": 128,
      "nll_per_sample": [
        1.8338420217311684,
        1.8702234159443292,
        1.7594457563550494,
        2.100598217555854,
        2.307898913441582,
        2.3039054316923537,
        2.052374557441094,
        1.9667928213893298,
        1.693993407398364,
        2.1001098766939323,
        1.562591441111924,
        1.987669393236479,
        1.6273404255319148,
        1.7793918001629108,
        2.0671735241502684,
        1.702176517571885,
        2.030948602124283,
        1.3080179282868525,
        1.9439442840156276,
        2.103284092296423,
        2.25601269686241,
        1.8689998394605876,
        1.5166285929737402,
        1.7260218631178708,
        1.9520205103162007,
        1.614149676474179,
        2.316811134171652,
        2.1435111707972165,
        1.8049383469661824,
        1.6515583692778628,
        0.879791844707606,
        2.0107434989622757,
        2.1091441826394823,
        1.805858203063319,
        2.037419118544744,
        2.024294957880601,
        2.1799733372833656,
        1.4737364180197778,
        2.2900596877869606,
        2.2131607862287876,
        1.7956293492858015,
        2.0492613844463436,
        1.914784519594677,
        2.06934440239287,
        1.5452936149432304,
        1.6494261223303792,
        2.3332926382615065,
        1.7281925283848125,
        1.845501159809547,
        1.156128576474744,
        1.9097790257599805,
        1.8480039067268954,
        1.588934181745874,
        1.7398617930532825,
        2.1522402637040656,
        1.7580271029178367,
        1.406055426687828,
        1.6350262483213283,
        2.1625289128758673,
        2.303992186546209,
        1.3975094616041996,
        2.1275790501770238,
        2.1715297277499697,
        1.9255280185569528,
        1.6566963740691003,
        1.5868941521181785,
        1.4968625498007968,
        2.3048467830545722,
        1.7679160053717495,
        1.8655841777560738,
        1.762361128067391,
        2.202295202051032,
        1.8426321572457576,
        1.937980710535954,
        2.2613636363636362,
        1.7532352582102309,
        1.678000244170431,
        1.7348309119765597,
        2.15053107068734,
        1.8242999096657633,
        1.9645952875106825,
        1.6112196313026492,
        2.069832743254792,
        1.8509339518984251,
        2.0405322915394946,
        1.878653221671509,
        1.5064722617354196,
        1.6123710026755,
        2.2748138200463925,
        2.3744353558784033,
        1.9945061653033818,
        1.6758332315956537,
        1.8203516054205835,
        2.0384954058192957,
        1.4618483701623732,
        1.9302893419606886,
        1.828592357465511,
        1.5622583762886597,
        1.9513774858602444,
        1.8560615309486022
      ],
      "compression_stats": {
        "avg_compression_ratio": 36.88060402701373,
        "sparsity_percentage": 3688.0604027013733,
        "total_keys_original": 193885440,
        "total_keys_kept": -1731122044,
        "total_keys_discarded": 1925007484,
        "memory_reduction_percentage": -3588.0604027013733,
        "num_chunks_with_compression": 5834,
        "layer_compression_ratios": {
          "0": 46.14829585005044,
          "1": 45.69425928436297,
          "2": 41.09063023392274,
          "3": 46.13036718846572,
          "4": 41.16810651688082,
          "5": 39.18019454984632,
          "6": 42.46908652655603,
          "7": 38.15232389549078,
          "8": 31.779267346529792,
          "9": 31.00142585352276,
          "10": 27.50313889873959,
          "11": 35.43667603838633,
          "12": 45.044002655103434,
          "13": 20.819589700931708,
          "14": 26.405253452113946,
          "15": 30.134752347862168,
          "16": 28.367111732258017,
          "17": 36.47696060751644,
          "18": 41.069229571806915,
          "19": 35.875714491634916,
          "20": 29.271214202392873,
          "21": 39.03142169130457,
          "22": 36.960592119704145,
          "23": 40.90365189244408,
          "24": 36.73003035698338,
          "25": 40.62141860196964,
          "26": 37.794588752088266,
          "27": 37.0119734951903,
          "28": 41.620880497646276,
          "29": 39.618283583089344,
          "30": 29.057838161137514,
          "31": 41.61104876850746
        },
        "sliding_window_size": 128,
        "total_keys_in_window": 3276800,
        "total_keys_outside_window": 190608640,
        "sparsity_with_window": 9.928581970879298,
        "sparsity_without_window": 10.099266664931873
      },
      "method_name": "H2O"
    }
  },
  "comparison": [
    {
      "method": "KVzap(no_sink)",
      "method_key": "kvzap(no_sink)",
      "perplexity": 6.567224335041404,
      "avg_nll": 1.8820912675879646,
      "ppl_delta": 0.0,
      "ppl_delta_pct": 0.0,
      "nll_delta": 0.0,
      "nll_delta_pct": 0.0,
      "density_overall": -436.69716250998533,
      "density_compressible": -445.9236554019797
    },
    {
      "method": "H2O",
      "method_key": "h2o",
      "perplexity": 6.567224335041404,
      "avg_nll": 1.8820912675879646,
      "ppl_delta": 0.0,
      "ppl_delta_pct": 0.0,
      "nll_delta": 0.0,
      "nll_delta_pct": 0.0,
      "density_overall": -892.8581970879299,
      "density_compressible": -909.9266664931873
    }
  ]
}